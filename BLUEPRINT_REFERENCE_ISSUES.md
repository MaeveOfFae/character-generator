# Blueprint Reference Issues - Found and Fixed

## Summary

The blueprint directory structure was reorganized from a flat layout to a hierarchical structure, but several files still reference the old paths.

## Current Blueprint Structure (Correct)

```
blueprints/
├── README.md
├── rpbotgenerator.md              # Main orchestrator
├── examples/
│   └── a1111_sdxl_comfyui.md      # SDXL alternate image prompt
├── system/
│   ├── offspring_generator.md      # Offspring synthesis
│   └── system_prompt.md            # System-level system prompt
└── templates/
    ├── example_image_only/
    │   ├── a1111.md               # A1111 image prompt
    │   ├── character_sheet.md      # Character data
    │   └── post_history.md        # Conversation context
    ├── example_minimal/
    │   ├── character_sheet.md
    │   ├── intro_page.md          # Markdown intro
    │   ├── intro_scene.md         # Opening scene
    │   ├── post_history.md
    │   └── system_prompt.md
    └── example_music_only/
        ├── character_sheet.md
        ├── post_history.md
        └── suno.md                 # Suno music prompt
```

## Issues Found

### 1. pyproject.toml - Package Manifest

**Problem**: References `../blueprints/**/*.md` which would include the old flat structure paths in the package.

**Status**: ✅ Actually OK - The recursive pattern `**/*.md` correctly includes all blueprint files regardless of structure.

### 2. MANIFEST.in - Package Manifest

**Problem**: Uses `recursive-include blueprints *.md` which is correct.

**Status**: ✅ Actually OK - This correctly handles the hierarchical structure.

### 3. bpui.egg-info/SOURCES.txt - Generated Package Manifest

**Problem**: Lists old flat structure paths:
- `blueprints/a1111.md` (doesn't exist)
- `blueprints/character_sheet.md` (doesn't exist)
- `blueprints/intro_page.md` (doesn't exist)
- `blueprints/intro_scene.md` (doesn't exist)
- `blueprints/post_history.md` (doesn't exist)
- `blueprints/system_prompt.md` (doesn't exist)
- `blueprints/suno.md` (doesn't exist)
- `blueprints/chub_rules.md` (deleted)

**Status**: ⚠️ This is a generated file, will be fixed by rebuilding the package.

### 4. README.md - Main Documentation

**Problem**: Shows old flat structure:
```markdown
├── blueprints/              # All prompt blueprints
│   ├── rpbotgenerator.md       # Main orchestrator
│   ├── system_prompt.md        # System prompt spec
│   ├── post_history.md         # Behavior layer
│   ├── character_sheet.md      # Character data structure
│   ├── intro_scene.md          # Opening scene
│   ├── intro_page.md           # Markdown intro
│   ├── a1111.md               # Image prompt (A1111)
│   ├── a1111_sdxl_comfyui.md   # SDXL alternate
│   └── suno.md                 # Song prompt (Suno V5)
```

**Status**: ❌ Needs updating

### 5. CONTRIBUTING.md - Contribution Guide

**Problem**: References old paths:
- "Create blueprint in `blueprints/your_asset.md`"
- Repository structure shows flat blueprint layout

**Status**: ❌ Needs updating

### 6. QUICKSTART.md - Quick Reference

**Problem**: Says "Blueprints: `rpbotgenerator.md`, etc. (repo root)"

**Status**: ❌ Needs updating

### 7. Package Metadata (.venv/.../METADATA and RECORD)

**Problem**: Lists non-existent blueprint files in old flat structure.

**Status**: ⚠️ These are installed package files, will be fixed by reinstalling.

## Code Analysis Results

### Files That Are Correctly Linked

1. **bpui/templates.py** - ✅ Correctly references the new hierarchical structure
   - `templates/example_minimal/system_prompt.md`
   - `templates/example_minimal/post_history.md`
   - `templates/example_minimal/character_sheet.md`
   - `templates/example_minimal/intro_scene.md`
   - `templates/example_minimal/intro_page.md`
   - `examples/a1111_sdxl_comfyui.md`
   - `templates/example_music_only/suno.md`

2. **bpui/prompting.py** - ✅ Uses `load_blueprint()` which resolves paths correctly

3. **blueprints/README.md** - ✅ Documents the new structure correctly

4. **bpui/gui/** - ✅ GUI components use TemplateManager which resolves paths correctly

5. **bpui/tui/** - ✅ TUI components use TemplateManager which resolves paths correctly

## Fixes Applied

### ✅ High Priority (Documentation) - COMPLETED

1. ✅ **README.md** - Updated repository structure diagram to reflect hierarchical blueprint layout
2. ✅ **CONTRIBUTING.md** - Updated blueprint development instructions with correct paths
3. ✅ **QUICKSTART.md** - Updated file locations section with proper blueprint directory structure

### ⚠️ Medium Priority (Package) - REQUIRES USER ACTION

The following files are generated by pip and will be updated when the package is reinstalled:

1. `bpui.egg-info/SOURCES.txt` - Will be updated by rebuild
2. `.venv/lib/python3.13/site-packages/bpui-1.0.0.dist-info/*` - Will be updated by reinstall

**To fix:** Run `pip install -e . --force-reinstall --no-deps`

## Root Cause

The blueprints were reorganized into a template system for better organization, but documentation wasn't fully updated to reflect this change. The code (bpui/templates.py) handles the new structure correctly via path resolution logic.

## Impact

- **Low**: Code works correctly - the TemplateManager resolves blueprint paths properly
- **Medium**: Documentation is misleading for contributors
- **Low**: Package metadata shows old structure but doesn't affect runtime (files are included via recursive patterns)

## Next Steps

After documentation fixes:
1. Rebuild package: `pip install -e . --force-reinstall --no-deps`
2. Verify SOURCES.txt reflects new structure
3. Test blueprint loading from all locations