Write production-ready code for the described feature.

Principles
- Favor clarity over cleverness.
- Prefer straightforward control flow and explicit naming.
- Add comments only where intent is non-obvious (not to restate code).

Requirements
- Handle errors intentionally (no silent failures).
- Validate inputs at the boundary.
- Keep responsibilities small and well-factored (seams for testing).

Output
- Provide the code with any necessary supporting types/helpers.
- Include brief usage notes (how to call it, expected inputs/outputs).
